import pandas as pd 
import os

numerical_features = 'vid,A,B,C,D,E,2403,2404,2405,2420,A701,A703,0424,0425,1321,1322,2406,1319,1320,1325,1326,3803,3804,3805,3807,0104,0105,0107,0108,0111,0112,A702,A704,0106,0109,2416,2417,2415,2407,2409,2410,2411,2412,2413,2414,3302,2421,3801,2408,3802,3810,3816,3817,3818,0421,3806,3811,2424,2425,2423,2422,0413,3814,0974,0436,2451,2452,2453,2454,0435,0703,3815,0440,0702,1104,0442,0438,0901,0439,0446,2428,0546,0454,0715,2426,2427,100005,100007,279006,31,312,313,314,315,316,317,319,32,320,33,34,37,38,39,1840,3193,1850,10004,190,191,2333,10009,2386,1106,1107,2372,10002,10003,1115,1117,1814,1815,183,1844,1845,192,193,2174,10013,300035,300087,20002,2390,143,1112,100012,1127,1345,1842,100013,100014,139,1474,155,899003,899004,899005,899006,899007,21A017,669007,669008,669009,100006,1137,2156,2161,300053,300054,300057,137,20001,2177,2371,2376,779011,809001,809002,809003,809004,809005,809006,809007,809008,809009,809010,809011,809012,809013,809014,809015,809016,809017,809018,809019,809020,809023,809024,809025,809026,809027,809030,809031,809032,809033,809034,809035,269003,269004,269005,269006,269007,269008,269009,269010,269011,269012,269013,269014,269015,269016,269017,269018,269019,269020,269021,269022,269023,269024,269025,2986,529106,809021,809029,269026,3429,369044,I49002,300005,300073,300074,300076,300078,300113,300125,300126,300127,709002,300064,699001,699003,699004,699005,699006,699007,699009,300001,100008,1337,669021,004997,300006,300007,300008,300009,300011,300012,300013,300014,709001,300037,300038,300039,300068,300069,300070,669001,669002,669003,669004,669005,669006,709043,669023,709003,300036,709031,300017,141,164,165,300030,300031,300032,1873,300021,300081,979001,979002,979003,979004,979006,979007,979008,979009,979010,979011,979012,979015,979016,979017,979020,979021,979022,979023,809022,360,739005,21A002,669024,759007,1110,1816,300092,129,1812,196,131,529104,1359,529111,669010,709044,1171,1363,709048,300028,779037,779038,899002,819007,819008,819009,819010,819011,819012,819013,819014,819015,819016,819017,819018,819019,819020,819021,819022,819023,819024,819025,819026,819027,819028,819029,819030,819031,459278,669035,729028,300010,300029,319100,300033,300034,300119,300129,2247,300134,300044,300071,2165,279001,279002,279004,279005,300015,300051,669043,669046,2387,769019,2157,2160,709030,300048,300050,140,300112,21A004,369070,300024,300146,300150,300151,300152,759006,809028,809036,30003,300121,300122,300123,300124,166,300055,21A021,3200,2168,300117,3195,979005,979013,979014,979018,979019,3762,300107,300109,378,709049,659025,709038,669012,2392,709029,300090,300115,1849,1136,10014,300099,300114,709004,709005,709006,709007,709008,709009,709010,709011,709012,709013,709014,709015,709016,709017,709018,709019,709020,709021,709022,709023,709024,709025,709026,419008,300020,41118,41119,369080,300145,2389,1451,100010,300019,300018,2277,I49007,459154,459155,459156,459158,459159,459161,459206,459207,459209,459210,459211,1346,1124,1125,509007,509008,509009,509065,509069,459328,459329,459330,459331,459332,459333,459334,459335,459336,459337,1461,459338,459340,509006,310,311,35,36,300084,809037,809038,809039,809040,809041,809042,809043,809044,809045,809046,809047,809048,809049,809050,809051,809052,809053,809054,809055,809056,809057,809058,809059,809060,809061,189,184,019015,669038,459212,1123,459181,459184,459183,459327,459208,459342,909021,459303,459162,459163,300086,459191,459232,459233,769001,769003,769004,1118,019003,279003,509002,319298,669040,10012,300075,509010,509011,509013,459141,F69020,F69021,F69022,F69023,F69024,F69026,F69028,F69029,F69032,F69033,F69034,F69035,179120,179163,439011,439014,439015,439017,439018,1471,300058,459213,3189,21A012,669044,669045,579088,979024,979025,979026,979027,179226,439016,300067,459171,579086,300093,609023,609024,609025,609026,300120,1135,2250,979028,459182,449174,449176,449177,509015,21A051,539002,539003,539004,759001,157,979029,F69006,20000,459167,299175,V59001,269027,369094,300059,300082,459152,459258,459122,459123,459124,459125,459185,459186,459188,459190,459192,459261,459115,459118,459120,459121,459126,459149,459150,459151,459263,459264,459265,459266,459267,459268,459269,459270,459277,459135,3191,3196,669037,30004,300042,300043,439035,1142,459137,3192,459306,300077,299168,339119,339120,339121,339122,339123,339124,319215,319216,459307,459326,1353,187,300072,459114,339125,339126,339127,339128,339129,339130,339131,300143,1848,30006,449128,449143,10005,319273,300130,339114,369108,319279,319280,319281,319282,319283,319284,319286,319287,319288,319289,319291,3438,269055,449152,839018,319293,300022,179176,179177,179178,459116,459117,269052,069007,069008,069010,346,2287,069044,069049,069050,069025,069026,156,319149,319150,319151,319152,319153,319154,319157,319159,319271,319272,1450,2163,069020,300116,300118,369007,369008,449134,019001,019002,069002,069003,069004,069005,21A057,21A056,3400,2385,459204,459205,3184,321,159063,300080,159053,339116,449180,449181,339105,300101,300133,769008,419007,128,019017,343,374,383,297,300175,300136,549005,549006,069048,069046,30001,449162,1349,449173,269035,269036,129061,129062,129063,129079,1,I69003,I69004,I69005,269056,269057,269058,279028,279053,129056,129057,129058,I49012,300165,069045,069047,069051,069052,069053,069054,069055,369098,069035,069066,300163,439022,179156,179195,179198,179199,179200,179201,179202,179203,439024,300144,D29008,D29009,D29010,D29011,1918,269069,439030,439031,179174,159068,279040,279041,279042,279043,X19011,069076,Y19001,129028,W59001,069092,069014,3485,179228,3430,069058,3207,899001,3486,279044,300066,2173,300061,134,279045,279055,Y19004,129014,129049,129050,300177,969002,1341,C49002,069023,069024,179216,1362,019059,269037,019008,159026,179173,439019,439012,069078,069079,069080,069081,069082,069083,069084,069085,069086,069089,069090,069091,L19008,Y79001,1354,1356,1357,1358,W29001,W19001,300003,4619,019049,019050,019051,019052,019053,019054,019055,019056,019032,019033,019034,019035,019036,019037,019038,019039,019040,019041,019042,019043,019044,019045,019046,019047,019048,019062,369085,339135,I49001,20004,2162,21A045,21A047,21A063,I19027,019058,3705,I49008,W69003,319185,21A162,I49003,300142,300153,300154,T59002,3190,929017,929008,369032,V79002,1131,2176,319172,X19003,019012,019004,019005,019006,019007,B19013,3831,300108,W99001,Y29021,069006,019057,319156,41114,3197,Q99001,319180,X19022,769007,20003,929016,049001,370,372,3829,3830,21A066,21A067,21A068,21A069,21A070,21A072,21A073,21A080,21A081,279034,161,162,459215,909040,909041,019029,559007,G59003,300060,909037,909038,909039,1350,909001,969001,839006,839007,839008,839009,839010,839001,839002,839003,839004,839005,179155,929015,929001,K29002,I19028,809062,I19034,I19035,10000,929007,159,269028,269029,269030,269031,G49050,669031,P19033,P89002,709027,1915,K79001,899021,899022,D29007,300111,979091,979092,979093,979094,979095,979096,1391,979090,979085,L49005,L49006,L49007,L49008,L49009,K89001,K89002,K89003,559078,559046,559047,1475,559160,319164,319166,T99001,T99002,179179,369103,I89001,U99001,559131,559059,369031,S29003,199118,339106,339107,E19080,300172,369107,Q99002,559011,P19013,4309,Q99004,Q99005,Q99006,Q99007,Q99008,Q99009,Q99010,Q99011,Q99012,Q99014,Q99015,Q99016,P59001,P59003,559157,559158,369009,369047,P19045,P19046,Q99003,Q99013,229080,559162,P59044,899045,909022,T69011,S29004,909023,1343,1456,P79001,1105,E39002,729003,L69005,269062,269063,269064,269065,269066,269067,669011,2984,279029,279030,K59024,K59025,K59026,K59027,819006,P19073,P19009,P19001,P19042,559137,879002,T69004,T69005,Y29002,Y29005,U99003,369077,369078,S39009,669039,U99009,Y29003,Y29004,319158,319161,369079,979082,979083,559156,3194,186,G99024,4641,669014,J29018,J29063,300137,300138,J29044,300166,300167,300168,300169,300170,300171,300173,300174,300176,300178,300179,300180,300181,300182,300183,300184,300185,300186,300187,300188,300189,300190,E39012,199115,J29050,J29101,X19001,X19002,769002,F79004,H39014,G99059,G99069,G99068,G99070,G99002,2167,E19079,I59002,G69008,819035,799003,X19004,F69025,F69027,F69030,21A019,G99018,G99011,G99085,G89001,229005,289010,F29013,300162,I49006,579114,J29054,369059,I49010,G99078,1839,371,E59002,229006,300088,300089,D59018,D59019,G99135,G99006,G99122,1994,199107,199108,199109,199110,199111,1457,369035,300140,300141,21A097,G99014,G99072,G99075,J99003,J99004,J99025,J99026,J99027,J99028,J99029,G99089,G99090,049038,049039,049040,049041,579110,21A205,21A204,G99003,G99077,G99055,I19030,819042,1108,21A006,2393,F99001,J29062,G99067,G99073,G99076,G99111,J29097,J29038,I49016,199112,J29039,K49025,579063,2175,579085,579087,579089,579090,579091,579092,579093,579095,579096,D59067,1847,369034,579097,579098,579084,J29110,439034,2265,J29102,J29103,J99030,J99031,G99028,G99091,019030,019031,559161,559016,F39042,I29025,G99023,G99110,G99126,G99125,G99074,2282,F39004,C19103,A49018,269061,3203,3205,3206,3211,3217,3725,989001,989002,989003,989004,989043,989065,P79002,949006,S39002,B39002,B39001,899029,899030,C19048,C19101,A59003,A59002,069015,779032,779033,779034,779035,300062,2278,859087,809063,C39002,C39001,949007,319167,319168,989005,989006,989007,2228,2229,2230,2231,2233,989048,859021,859023,859025,859084,859014,A29007,319155,809075,809076,809077,C89005,989021,S39001,2985,A29002,989067,1917,2155,21A217,21A218,21A233,909036,769005,21A036,C59002,A49024,C29004,929013,229022,949005,C29050,C29051,C29052,C29053,C29054,C29055,C29056,C29057,C29058,C29059,C29060,C29061,809071,979058,979060,979067,A69002,A69003,A69004,A69006,A69007,799009,709032,3721,300025,21A020'.split(',')

data = pd.read_csv('data.csv', sep = '$')

names = data['table_id'].unique()
print(names)
print(len(names))
names = ['0102', '0101', '1815', '1308', '1814', '2302', '190', '0113', '2404', '0114', '2403', '0116', '2405', '0118', '0117', '191', '1001', '3430', '1840', '3195', '3192', '3197', '3191', '3193', '3196', '3190', '1850', '10004', '300005', '0115']

for name in names:
    if name in numerical_features:
        continue
    data_n = data[data['table_id'] == name]
    #print(data_n['field_results'].value_counts())
    #print(data.info())
    #print(data.sample(10))

    data_n = data_n[['vid', 'field_results']]
    data_n.to_csv('texts_vid/' + name + '.csv', index = False, header = False)

'''
names = os.listdir('texts/')
for name in names:
    f = open('texts/' + name)
    lines = f.readlines()
    f.close()
    if len(lines) > 10000:
        os.system('cp texts/' + name + ' texts_10000/' + name)
'''
    
    
    
    